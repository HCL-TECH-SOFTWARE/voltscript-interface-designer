---
class: 512
flags: 0x0000
unid: OF2E2F4144EE14C2E5-ON0056724485258A43
items:
  - name: $AssistAction
    type: action
    code_type: 65413
    data: |
      '++LotusScript Development Environment:2:5:(Options):0:74
      %REM
      	Agent Tools\Compute With Form 
      	Created Jul 13, 2023 by Devin Olson/USA/PNPHCL
      	Runs NotesDocument.ComputeWithForm() and then re-saves all selected documents.
      %END REM
      %REM
      	**********************************************************************
      	**********************************************************************
      		
          Copyright HCL America, Inc. 1999, 2023
      
         	Licensed under the Apache License, Version 2.0 (the "License");
          you may not use this file except in compliance with the License.
          You may obtain a copy of the License at
      
              http://www.apache.org/licenses/LICENSE-2.0
      
          Unless required by applicable law or agreed to in writing, software
          distributed under the License is distributed on an "AS IS" BASIS,
          WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
          See the License for the specific language governing permissions and
         	limitations under the License.
      
      	**********************************************************************
      	**********************************************************************
      %END REM
      Option Public
      Option Declare
      Use "BSXnotesUtils"
      
      
      '++LotusScript Development Environment:2:5:(Forward):0:1
      Declare Sub Initialize
      
      '++LotusScript Development Environment:2:5:(Declarations):0:10
      
      
      Private Const MODULE_NAME = |Agent: Compute With Form|
      
      
      %REM ***************************************************************************
       ************************************************************************************
      	MessageBox CONSTANTS  
      	MessageBox constants declared here to avoid conflicts with 
      	other libraries using lsconst.lss; which has its own 
      	%INCLUDE "lsprcval.lss" command.
       ************************************************************************************
      %END REM *********************************************************************
      Private Const MB_OK = 0 				' OK
      Private Const MB_OKCANCEL = 1 			' OK And Cancel 
      Private Const MB_ABORTRETRYIGNORE = 2 	' Abort, Retry, And Ignore 
      Private Const MB_YESNOCANCEL = 3 		' Yes, No, And Cancel
      Private Const MB_YESNO = 4 				' Yes And No 
      Private Const MB_RETRYCANCEL = 5		' Retry And Cancel 
      
      Private Const MB_ICONSTOP = 16 			' Stop sign
      Private Const MB_ICONQUESTION = 32 		' Question mark 
      Private Const MB_ICONEXCLAMATION = 48 	' Exclamation point
      Private Const MB_ICONINFORMATION = 64 	' Information 
       
      Private Const IDOK = 1 					' OK
      Private Const IDCANCEL = 2 				' Cancel
      Private Const IDABORT = 3 				' Abort
      Private Const IDRETRY = 4 				' Retry
      Private Const IDIGNORE = 5 				' Ignore
      Private Const IDYES = 6 				' Yes
      Private Const IDNO = 7 					' No
      
      '++LotusScript Development Environment:2:2:Initialize:1:10
      Sub Initialize
      	On Error Goto ErrorTrap
      	
      	Dim unids As StringQueue 
      	Dim ndoc As NotesDocument 
      	Dim unid As String  
      	
      	Dim extendedinfo List As String 
      	Dim msg$
      	
      	
      	' BEGIN CODE
      	Set unids = getCollectionUNIDs(getCurrentDb().UnprocessedDocuments)
      	 
      	If (unids Is Nothing) Then Goto ExitPoint 
      	
      	enhLogExtendedContent MODULE_NAME, ||, |Processing | & Format$(unids.size, FORMAT_WHOLE_THOUSANDS) & | documents.| 
      	While unids.hasContent 
      		unid = unids.pop() 
      		extendedinfo(|UNID|) = unid 
      		Set ndoc = getDocumentByUNID(unid)
      		If ndoc.ComputeWithForm(True, False) Then 
      			If ndoc.Save(True, False, False) Then 
      				enhLogExtendedContent ||, ||, |Saved | & unid
      			Else
      				Error ERR_DOC_NOT_SAVED, MSG_DOC_NOT_SAVED 
      			End If
      		End If
      	Wend
      
      	Messagebox |Operation Complete|, MB_ICONINFORMATION, |Finished|
      	
      ExitPoint:
      	Exit Sub 
      ErrorTrap:
      	On Error Goto 0
      	pushExceptionCarrier MODULE_NAME, ||, extendedinfo
      	
      	msg$ = |Error: | & Error$() 
      	Forall s In extendedinfo
      		msg$ = msg$ & CRlf & Listtag(s) & |: | & s
      	End Forall
      	
      	Messagebox msg$, MB_ICONSTOP, |Operation Failed| 
      	Resume ExitPoint	
      End Sub
    dwFlags: 0x00000000
    signed: true
    nonsummary: true
  - name: $AssistDocCount
    type: number
    data: 0
    signed: true
  - name: $AssistFlags
    type: text
    data: Es
    signed: true
  - name: $AssistInfo
    type_num: 17
    type: opaque
    opaque: |
      AQAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
    signed: true
    nonsummary: true
  - name: $AssistLastRun
    type: time
    signed: true
  - name: $AssistQuery
    type_num: 15
    type: opaque
    opaque: gQYAAAAA
    signed: true
    nonsummary: true
  - name: $AssistRunInfo
    type: object
    obj_type: 0x0008
    obj_class: 0x0200
    obj_privs: 0x0000
    opaque: |
      AAAAAAUAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
      L3FqAFuKJYXgZVsAOYolhQAAAAAAAAAAAAAAAAAAAAAAAAAAqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq
      qqqqqqqqqqqqqqqq
  - name: $AssistTrigger
    type: text
    data: "4"
  - name: $AssistType
    type: number
    data: 65413
    signed: true
  - name: $Comment
    type: text
    data: "Resets the ancestor ID fields (F_ProjectID, F_ClassID, F_TypeID) for all selected documents."
    signed: true
  - name: $DesignerVersion
    type: text
    data: 8.5.3
  - name: $Flags
    type: text
    data: 3fL
  - name: $FlagsExt
    type: text
    data: ""
    signed: true
  - name: $Restricted
    type: number
    data: 1
    signed: true
  - name: $TITLE
    type: text
    data: "Tools\\Compute With Form"
    signed: true
remaining: []